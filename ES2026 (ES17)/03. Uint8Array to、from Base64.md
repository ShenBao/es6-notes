# Uint8Array to/from Base64

该提案旨在为 JavaScript 的 Uint8Array 添加内置方法，以方便地在二进制数据和常见的字符串编码（Base64 和十六进制）之间进行转换。

为什么需要这个提案？

目前开发者需要依赖 atob/btoa（处理字符串，且在 Node.js 中有局限）或第三方库来实现 Base64 编解码。这个提案直接在 Uint8Array 上提供原生、高效且功能完整的支持，使处理二进制数据更加方便和标准化。

## 核心功能

该提案主要增加了以下四个方法：

- Uint8Array.prototype.toBase64(): 将 Uint8Array 实例编码为 Base64 字符串。
- Uint8Array.fromBase64(string): 从 Base64 字符串创建一个新的 Uint8Array 实例。
- Uint8Array.prototype.toHex(): 将 Uint8Array 实例编码为十六进制字符串。
- Uint8Array.fromHex(string): 从十六进制字符串创建一个新的 Uint8Array 实例。

```js
// 编码示例
let arr = new Uint8Array([72, 101, 108, 108, 111, 32, 87, 111, 114, 108, 100]);
console.log(arr.toBase64()); // 输出: 'SGVsbG8gV29ybGQ='
console.log(arr.toHex());    // 输出: '48656c6c6f20576f726c64'

// 解码示例
let base64String = 'SGVsbG8gV29ybGQ=';
console.log(Uint8Array.fromBase64(base64String)); // 输出: Uint8Array([72, 101, 108, 108, 111, 32, 87, 111, 114, 108, 100])

let hexString = '48656c6c6f20576f726c64';
console.log(Uint8Array.fromHex(hexString));      // 输出: Uint8Array([72, 101, 108, 108, 111, 32, 87, 111, 114, 108, 100])
```

## 高级特性

- Base64 选项: fromBase64 和 toBase64 方法支持一个选项对象，可以指定：
    - alphabet: 使用 base64 (标准) 还是 base64url (URL 安全) 字母表。
    - omitPadding: 编码时是否省略 = 填充符。
    - lastChunkHandling: 解码时如何处理不完整的最后一块数据。
- 写入现有数组: 提供了 setFromBase64() 和 setFromHex() 方法，可以将解码后的数据写入一个已存在的 Uint8Array，类似于 TextEncoder.encodeInto()。
- 空白字符处理: Base64 解码器允许在字符串中包含 ASCII 空白字符（如空格、换行），而十六进制解码器则不允许。


## link

- https://github.com/tc39/proposal-arraybuffer-base64
